# 🧠 Cipher設計思想・アーキテクチャ

## 📁 3層設定構造
Cipherは以下の3層設定システムを採用：

### 1. インストール先の.env（必須）
- **場所**: `/opt/homebrew/lib/node_modules/@byterover/cipher/dist/.env`
- **役割**: 基本設定・デフォルト値
- **内容**: 最小限の環境変数定義
- **重要**: この.envファイルがないとCipher起動不可

### 2. カスタム設定ファイル（プロジェクト固有）
- **場所**: `~/.cipher/cipher.yml`
- **役割**: プロジェクト固有設定・LLMプロバイダー選択
- **内容**: Anthropic/OpenAI切り替え、モデル選択、システムプロンプト
- **利点**: プロジェクトごとの独立設定

### 3. 環境変数（実行時）
- **役割**: 実行時のAPI KEY上書き・セキュリティ
- **方法**: `ANTHROPIC_API_KEY="..." cipher --agent ~/.cipher/cipher.yml`
- **利点**: API KEYをファイルに保存せずセキュア実行

## 🔧 動作原理
1. インストール先.env読み込み（基本設定）
2. カスタム設定ファイル読み込み（上書き）
3. 環境変数で最終上書き（実行時）

## 🛡️ セキュリティ設計
- API KEYは環境変数でのみ渡す
- 設定ファイルには機密情報を記録しない
- 3層分離でリスク最小化